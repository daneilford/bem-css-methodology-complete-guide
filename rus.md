#b_ BEM CSS методология: Полное руководство

Главное: классы b-someblock__someelement__element__element-modificator - это не BEM!
Как правильно верстать по BEM - читайте ниже.

1. Длинное необязательное вступление
2. Суть #b_
 - Зачем это всё?
 - Блок
 - Элемент
 - Модификатор
 - Префикс b- и его воображаемые друзья: l-,i-,g- и еретический js-
 - Как менять внешний вид блока: правила модификации
3. Три главных правила
4. Ошибки, про которые нигде не написано
5. Типичные вопросы, ответов на которые вы не нашли на bem.info
6. Альтернативы или же братья: SMASS, OOCSS, MCSS и BEM.
7. Семантика в BEM.
8. BEM и CSS-препроцессоры: Sass и LESS.
9. Путь Яндекса: кому и зачем нужны bem-tools и прочие "ужасы"
10. bem-bl и bem-bl в сниппетах от Яндекса (скоро!)
11. Альтернативные реализации BEM-методологии
12. Примеры сайтов на BEM
- Яндекс-сайтов по BEM
- НЕ-Яндекс-сайтов по BEM
- Редизайна по BEM
13. Отзывы: Мнения людей меняется за пару месяцев работы с BEM. Путь к пониманию.
14. BEM для атеистов - почему это не религия


## 1. Длинное необязательное вступление
История понимания BEM и зачем он нужен. 
Можно смело пропустить и читать сразу пункт №2.

— Я не понимал BEM ("что за ерунда придуманная программерами, которые не знают CSS"). Нет не программерами. И не ерунда.
— Потом я думал что понимал BEM ("[у меня типа независимые стили: специфичность длиной в ширину экрана](http://delka.name/blog/2013/04/bem-otkroveniya-prinyavshih-veru/)").
— Потом не знал как же правильно его применять, особенно в рамках веб-студии.

Теперь понимаю и знаю. И хочу рассказать и доказать вам что BEM - единственный правильный вариант организации вёрстки. 
- Да-да, и для небольших студий, у которых не один большой, а множество средних проектов. 
- И для фрилансера с маленькими сайтами.
- И для лендингов. 
- И даже когда вы делаете правки в чужом спагетти-коде - вы можете (и должны) примерять BEM!

В BEM прекрасно вписываются SMACSS, OOCSS, MCSS. Большинство не знает что такое BEM, или думает, но знает неправильно. Если вы знаете что такое BEM и считаете что он не для вас (или вообще только Яндексу нужен) - дочитайте до конца. Я расскажу вам о том что BEM - это не "xslt, bem-bl, xml, bem-tools, js", а это методология которая решает проблемы с которыми сталкиваемся мы все. Нужная всем. Незаменимая для компаний, значительно ускоряющая скорость и стоимость разработки, поддержки, развития, передачи проекта другим разработчикам, масштабирования. Это прорыв уровня ООП для CSS.

И более того: BEM - семантичен как ничто другое при правильном применении!
Поехали, я расскажу вам о тех идеях и логике, что стоят за BEM, и почему и как вы можете его использовать!

Существует огромное кол-во статей, докладов, презентаций про BEM. Почти все - от Яндекса. Я читал все статьи, все доклады по BEM, ездил на субботники, общался с Харисовым, Ткаченко и разработчиками библиотеки bem-bl. Но чтоб понять всё (а не думать что понял) мне потребовалось 5 лет.

Вообще если бы было меньше бредовых статей типа этой: http://habrahabr.ru/post/203440/ которые пишут те, кто сам ничего не понял, было бы лучше. И ошибок было бы меньше.

## 2. Суть #b_
### 2.1 Зачем это всё?
#### Главная проблема вёрстки: каскад. 
Зачем был придуман BEM? Чтоб уйти от каскада. 

##### Почему надо уходить от каскада?
Идея убрать каскад кажется дикой - как, это же каскад. У нас каскадные таблицы стилей! Каскад сверху до низу по всей странице! Мы в ~~детстве~~ 2000-х играли в игру "кто напишет меньше тегов"!
 
Но. У нас страница состоит из блоков. Независимых блоков. Ее части не есть один большой текст, со стилями что спускаются вниз. Это блоки, что могут и должны иметь возможность переноситься.


#### Разновидности BEM: НБ, АНБ, Лего, текущий BEM, BEM-CSS у "не Яндекса". 
Всё это BEM. Разновидности называются "подмножествами BEM".

#### Что не является BEM.
НЕ BEM:
- длинные строки каскада ради высокой специфичности селекторов - это не та независимость и ни разу не BEM.
- базовые стили и их переопределения ниже _от_контекста_ - как общий стиль вёрстки
- BEM это не только bemjson, bem-tools и прочее. АНБ - тоже BEM

#### Главные правила BEM.
Чтобы их осознать, мы с вами должны вспомнить как писать правильно. Вспомнить правила.
Я говорю "вспомнить", потому что то о чем мы будем говорить - это ручная верстка по BEM.
В правильных терминах bem это называется "CSS подмножество BEM". 
Потому что bem он не только про CSS.

Нам придётся совершить экскурс в историю и пройти путь развития BEM чтобы сформулировать четкие правила "BEM CSS" из общей методилогии.
Чтоб собрать все пришлось читать апокрифы. Нет единого стандарта. Есть множество толкований - диалектов BEM. Евангелие от Вегеда, проповедь на внутренней коференции и статьи других апостолов, простите евангелистов BEM. Сам BEM допускает множество вариантов самой методологии. А уж какой путь выбирать в каждом конкретном случае, при модификации кода например - можно спорить и спорить. Поэтому -тот- старый добрый ручной BEM и правду похож на религию. 

Сводим всё из разных источников. Очень подробно. Много примеров.

##### .block
Главное в BEM - понятие независимого блока.</h2>
> Независимый блок (НБ или просто блок) это самодостаточный элемент страницы, который при перемещении в другое место на странице или на другую страницу не теряет своей самодостаточности.
> BEM.Клуб на Я.рушке, [Независимый блок](http://clubs.ya.ru/bem/replies.xml?item_no=4)

__Формальное определение__
> Правила независимости блока:
> 1. для описания элемента используется class, но не id
> 2. каждый блок имеет префикс
> 3. в таблице стилей нет классов вне блоков
> BEM.Клуб на Я.рушке, [История создания BEM (часть первая)](http://clubs.ya.ru/bem/replies.xml?item_no=1398)

Формальное определение нужно только затем чтоб описать при каких условиях он должен таким стать.
Что такое стили вне блоков я опишу ниже.

__"Как его таким написать?"__ 
Просто писать стили тупо на каждый блок. BEM хорош тем, что позволяет не забивать голову ерундой с каскадом, а сосредоточимся на семантике и логике кода. А с препроцессорами BEM позволяет писать еще и очень чистый и логичный код. Но про это чуть позже.

__Как проверить?__
Просто навести на блок в инспекторе кода. У него не должно быть каскада.
Слайд инспектор кода


##### .block__element
Не бывает элементов вложенных в элементы!

Я тоже раньше так писал:
```css
.form-buy-results__to-city__slider__tab__column_buy
```
Так делать нельзя.

__Как надо?__
```html
<div class='block'>
  <div class='block__elem1'>
    <div class='block__elem2'></div>
  </div>
  <div class='block__elem3'></div>
</div>
```

А в CSS:
```css
.block {}
.block__elem1 {}
.block__elem2 {}
.block__elem3 {}
```

__Если вам нужно сделать элемент у элемента, значит вам нужно сделать новый блок!__
Вместо:
```html
<div class='block'>
    <div class='block__elem1'>
        <div class='block__elem1__elem2'></div>
    </div>
</div>
```
Надо делать новый блок
```html
<div class='block1'>
    <div class='block2'>
        <div class='block2__elem'></div>
    </div>
</div>
```

__Не пишите странные имена__
```css
.block {}
.blockelem1 {}
.blockelem1__elem2 {}
```
У вас будут проблемы при переносе:
```html
<div class="someblock">
  <div class="blockelem1__elem2"></div>
```

Бейте на блоки!

##### Модификатор
Модификаторы в #yandex #b_:
```css
.block-name__elem_key_value
```

Но для всего мира ([csswizardry](http://csswizardry.com/2013/01/mindbemding-getting-your-head-round-bem-syntax/),[cssguidelin](http://cssguidelin.es/#bem-like-naming),[sitepoint](http://www.sitepoint.com/bem-smacss-advice-from-developers/)) это:
```css
.blockname__elem--mod {}
```
Синтаксис модификаторов `.blockname__elem--mod` был запущен в 2012 с легкой руки Nicolas Gallagher @necolas в http://nicolasgallagher.com/about-html-semantics-front-end-architecture/
Причина:
> This is merely a naming pattern that I’m finding helpful at the moment. It could take any form. But the benefit lies in removing the ambiguity of class names that rely only on (single) hyphens, or underscores, or camel case.
> http://nicolasgallagher.com/about-html-semantics-front-end-architecture/

> The reason for double rather than single hyphens and underscores is so that your block itself can be hyphen delimited, for example:
> http://csswizardry.com/2013/01/mindbemding-getting-your-head-round-bem-syntax/

###### Сокращённые модификаторы

Вариацией модификаторов являются "Сокращенные модификаторы" через multiple classes 

```html
 <div class="blockName -mod_val"></div>
```
```scss
.blockName {
  &.-mod_val {}
}
```
Синтаксис с "-", а не с "_", т.к. иначе имя класса будет не валидно.

Стили модификаторов НЕ пишутся без привязки к имени блока 
То что в Классическом BEM пишется как `.block_mod_val {}`
в сокращенных модификаторах пишут как `.block.-mod_val {}`

Компании и разработчики, которые используют сокращённые модификаторы:
* [Dan Tello "Sassier (BE)Modifers"](http://viget.com/extend/bem-sass-modifiers)
* [iDeus Team](https://github.com/ideus-team/guidelines/blob/master/frontend/bem.md)
* [2Gis](https://twitter.com/Chaptykov/status/570587770432962561)
* [Одноклассники](https://twitter.com/from_anywhere/status/570602747915059200)

Проблемы с сокращенными модификаторами:
 - Если у вас генерация html кода
 - Если у вас миксование блоков с модификаторами: http://codepen.io/hudochenkov/pen/OPEMwK?editors=110
 - Доводы от BEM-team: http://getbem.com/faq/#why-the-modifier-classes-are-prefixed
 - "когда ты начнёшь использовать i-bem.js и добавлять/удалять модификаторы динамически, ты поймёшь, что сокращённая запись этому мешает" (c) harisov https://twitter.com/harisov/status/571191436315631616
 
###### Сравнение Сокращённых модификаторов и BEViS состояний
...

##### Абстрактные блоки
Абстрактный блок = блок который является основой других блоков, но сам не существует в верстке без миксования с другми.
Тут ещё формальные определения из Ярушки и примеры.


###### Разница между модификатором и абстрактным блоком
Модификаторы - изменяют или дополняют уже существующий блок. Они нужны тогда когда у вас есть _уже готовый блок_, который _не сильно_ изменяется и это реализовывается модификаторами.
А абстрактные блоки - это кирпичи для _ещё не построенного блока_, с их помощью можно построить _значительно отличающиеся_ блоки.

Итого - если вам надо:
 * набор похожих блоков - модификаторы
 * набор сходных, но непохожих блоков - абстрактные классы


- Префикс b- и его воображаемые друзья: l-,i-,g- и еретический js-
   
А префикс js- (недолго существовавший как с- в #b_) вероятно тоже популяризировал Nicolas Gallagher @necolas в той же статье http://nicolasgallagher.com/about-html-semantics-front-end-architecture/
 
 - Как менять внешний вид блока: правила модификации

##4. Ошибки, про которые нигде не написано
### 1. Повторение DOM-дерева

### 2. Привязка к блоку-родителю
https://twitter.com/delaz/status/580353955244482560

##8. BEM и CSS-препроцессоры: Sass и LESS.
Extend-Only Selectors в Sass == абстрактный блок (i-блок) в #b_
```SCSS
%i-block {
  // стили абстрактного блока
}
.b-block {
  @extend %i-block;
}
```
